; by Poikilos
[gcode_macro M420]
gcode:
  {% if params.S == "1" or 'L' in params %}
    {% if 'L' in params %}
      BED_MESH_PROFILE LOAD=mesh{params.L}
      {action_respond_info("M420 L%s loaded mesh%s" % (params.L, params.L))}
    {% else %}
      BED_MESH_PROFILE LOAD=default
      {action_respond_info("M420 S%s loaded default" % (params.S))}
    {% endif %}
  {% elif 'S' in params %}
    ; S is a boolean, so we can assume 0 if not 1
    BED_MESH_CLEAR
    {action_respond_info("M420 S%s disabled mesh" % (params.S))}
  {% endif %}